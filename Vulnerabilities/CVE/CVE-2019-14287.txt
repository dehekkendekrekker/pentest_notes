Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-12-09T19:56:38-05:00

====== CVE-2019-14287 ======
Created Thursday 09 December 2021

===== Description =====
In Sudo before 1.8.28, an attacker with access to a Runas ALL sudoer account can bypass certain policy blacklists and session PAM modules, and can cause incorrect logging, by invoking sudo with a crafted user ID. For example, this allows bypass of !root configuration, and USER= logging, for a "sudo -u \#$((0xffffffff))" command.
References

The issue occurs when a sysadmin inserts an entry into the sudoers file, for example:

{{{code: lang="texinfo" linenumbers="False"
jacob myhost = (ALL, !root) /usr/bin/bash
}}}


This entry means that user jacob is allowed to run “chmod” as any user except the root user, meaning a security policy is in place in order to limit access — sounds good, right? 

Unfortunately, Joe Vennix from Apple Information Security found that the function fails to parse all values correctly and when giving the parameter user id “-1” or its unsigned number “4294967295”, the command will run as root, bypassing the security policy entry we set in the example above. 

Privesc with
{{{code: lang="texinfo" linenumbers="False"
sudo -u #-1 /usr/bin/bash
}}}


===== Versions affected =====

Sudo < 1.8.28

===== SEE =====
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14287
