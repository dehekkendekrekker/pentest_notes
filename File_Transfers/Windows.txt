Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-16T16:54:57-05:00

====== Windows ======
Created Saturday 16 October 2021

====== Downloading files ======

===== Windows target, [[/w]] remote desktop session active =====

==== Using browser ====
* Spawn http server on target machine
* Use browser to download file

===== Windows target, [[/w]] command execution =====

==== Using FTP ====
* Spawn FTP server on linux ([[Tools:Linux:PureFTPD]])
* Use instruction [[Tools:Windows:ftp|here]] to setup a download script
* Execute ftp command, specifying the script

=== Remarks ===
* This is likely to fail when coming from a public network. However, it might work when coming from a private network / same domain.
* This can be extended to pop a non-interactive shell, simply download nc.exe and pop a reverse shell ([[Tools:MultiPlatform:NetCat]])


==== Using VBScript (Windows XP, Windows Server 2003) ====

See +Windows:VBScript for usage details.

==== Using PowerShell ====
* See [[Tools:Windows:PowerShell]] for which versions. (Basically everything upward from XP SP2)
* See [[+PowerShell]] more usage details.

==== Using PackAndPaste Strategy ====
* See [[+PackAndPaste]] how to use
* Requires powershell


====== Uploading files ======

==== Using Apache2 with POST request ====
* See [[+Apache]] how to use
* Requires powershell

==== Using TFTP ====
* See [[+TFTP]] for details
* Requires tftp.exe on target



====== Both directions ======

==== Requirements ====
* You need to have a username and password to the target machine
* The machine needs to run SMB
* The username must be an admin

See if the machine exports network shares
{{{code: lang="sh" linenumbers="False"
smbclient -L <ip>  -U <username>
}}}


Mount as follows:
{{{code: lang="sh" linenumbers="False"
sudo mount -t cifs [-o port=<port>] //<host>/<sharename> -o username=<username>,password=<passwd> <mountpoint>
}}}




===== SEE =====
[[Tools:Windows:ftp]]
[[Tools:Linux:PureFTPD]]
[[Technologies:FTP]]
[[Tools:MultiPlatform:NetCat]]
[[Tools:Windows:PowerShell]]
[[Tools:Linux:smbclient]]
[[Technologies:SMB]]
[[Tools:Linux:mount]]
