Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-26T10:46:11-05:00

====== SAM ======
Created Tuesday 26 October 2021

===== Security Accounts Manager (SAM) =====
* Stores Hashed Passwords
* Partially encrypted since NT4.0 SP3 (SYSKEY) to deter offline password cracking
* In memory, the password hashes are cached in the Local Security Authority SubSystem (LSASS)

Windows NT up until 2003 uses two sets of password hashes
* LM (Lan Manager), based on DES (Weak)
* NTLM (NT Lan Manager), based on MD4

==== Lan Manager ====
* Uses DES as crypto
* Passwords longer than 7 chars are split into two strings and hashed separately
* Each password string is converted to upper case before being hashed
* Does not include salts
* Hash lookup attack feasible

Windows Vista and onwards use only NTLM

==== NT Lan Manager ====
* Supports case-sensitivity
* Supports all unicode characters
* Does not split password in smaller, weake parts
* Still not salted

===== Extracting hashes =====
* SAM File can not be copied when the system is running, as the operating system keeps an exclusive lock.
* We can use [[Tools:Windows:mimikatz]] to extract hashes from the LSASS




===== SEE =====
[[Tools:Windows:mimikatz]]
