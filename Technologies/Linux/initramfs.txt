Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2022-01-27T11:14:49-05:00

====== initramfs ======
Created Tuesday 25 January 2022

* The only purpose of the initramfs is to mount the root filesystem.
* The initramfs is a complete set of directories you would normally find on a filesystem.
* It is bundled into a single cpio archive and compressed with one of serveral compression algorithms.
* It contains the kernel modules that will be loaded, unless they are statically compiled into the kernel itself.


===== Microcode =====
This basic initramfs image may be prepended with an uncompressed cpio archive holding the microcode data loaded very early in the boot process. 

===== Boot time =====
From the first couple of blocks of the image, the kernel identifies the format which leads to either the initrd scheme or initramfs scheme

==== initrd ====
* The image is made available as a special block device in /dev/ram, that is then mounted as the initial root filesystem. The driver for this filesystem must be statically compiled into the kernel.
* Once the initial filesystem is setup, the kernel executes /linuxrc as its first process.
* When it exits, the kernel assumes that the real root file system has been mounted and executes /sbin/init to begin the normal user-space boot process.



==== initramfs ====
* If an uncompressed cpio archive exists at the start of the initramfs, extract and load the microcode from it to the CPU.
* If an uncompressed cpio archive exists at the start of the initramfs,skip it and set the rest of the file as the basic initramfs. Otherwise, treaed the while initramfs as basic initramfs

* Unpack the init ramfs, by treating it as compressed cpio archive into a RAM based disk
* Mount and use the RAM based disk as the initial root filesystem.



===== SEE =====
* https://wiki.debian.org/initramfs
* https://en.wikipedia.org/wiki/Initial_ramdisk
