Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2020-03-14T19:28:09-05:00

====== OAuth ======
Created Saturday 14 March 2020

Attack vectors:
https://dhavalkapil.com/blogs/Attacking-the-OAuth-Protocol/

A webite using OAuth should create a link containing the following:

https://authserver/auth?response_type=code&client_id=CLIENT_ID&redirect_uri=REDIRECT_URI&scope=SCOPE&state=STATE

* response_type=code indicates the webserver expects an authorization code
* CLIENT_ID idicates the id of the webapp and should be registered with the authserver
* REDIRECT_URI indicates the the URI the user should be redirected to after authorization is complete
* SCOPE indicates what type of access, or which type of access on the user account the server wants
* STATE random string that will be verified by the webserver later

example in oouch box on htb:
authorization.oouch.htb:8000/oauth/authorize/?client_id=UDBtC8HhZI18nJ53kJVJpXp4IIffRhKEXZ0fSd82&response_type=code&redirect_uri=http://consumer.oouch.htb:5000/oauth/connect/token&scope=read

* response_type=code
* client_id=UDBtC8HhZI18nJ53kJVJpXp4IIffRhKEXZ0fSd82
* redirect_uri=[[http://consumer.oouch.htb:5000/oauth/connect/token&scope=read|http://consumer.oouch.htb:5000/oauth/connect/token]]
* scope=read
* NO STATE param

