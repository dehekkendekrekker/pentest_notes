Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-09-09T10:38:26-05:00

====== TCPDump ======
Created Thursday 09 September 2021

Packet capture and reading tool.

Command line args
{{{code: lang="sh" linenumbers="False"
-n    No DNS lookup
-r    Read .pcap file
-A    Print each packet (minus its link level header) in ASCII.  Handy for capturing web pages.
}}}


=== Filtering ===
{{{code: lang="sh" linenumbers="False"
sudo tcpdump -n -r password_cracking_filtered.pcap | awk -F" " '{print $5}' | sort | uniq -c | head
}}}


* Reads pcap file
* Splits on " " and take field 5 (dest ip)
* Sorts on IP addres
* Counts unique IP's and groups by IP
* Takes the first 10? 20? rows

=== Advanced filtering ===
{{{code: lang="sh" linenumbers="False"
tcpdump 'tcp[13] = 24'
tcpdump 'tcp[tcpflags] & (tcp-psh|tcp-ack) == (tcp-psh|tcp-ack)'
}}}

* This filters packets with the PSH and ACK flag set
* The 13 is the index to the byte that holds the flags
