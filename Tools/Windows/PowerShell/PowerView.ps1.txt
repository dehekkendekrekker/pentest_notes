Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-29T14:15:12-05:00

====== PowerView.ps1 ======
Created Friday 29 October 2021

===== Description =====

Enumeration script for windows machine

===== Website =====
https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon

===== Installation =====
Installed by default here:
{{{code: lang="sh" linenumbers="False"
/usr/share/windows-resources/powersploit/Recon/PowerView.ps1
}}}


Update:
{{{code: lang="sh" linenumbers="False"
sudo wget https://github.com/PowerShellMafia/PowerSploit/raw/master/Recon/PowerView.ps1 -O /usr/share/windows-resources/powersploit/Recon/PowerView.ps1
}}}


===== Usage =====
Upload PowerView.ps1 to the target host

{{{code: lang="sh" linenumbers="False"
powershell -ExecutionPolicy Bypass
}}}

{{{code: lang="powershell" linenumbers="False"
Import-Module .\PowerView.ps1   # Don't forget the the .\ else it will look in the modules directory
}}}


===== Commands =====
{{{code: lang="texinfo" linenumbers="False"
Get-Help <command>																						Returns help about command


Get-NetLoggedon [[-ComputerName] <String[]>] [-Credential <PSCredential>] [<CommonParameters>]   		Get logged in users
Get-NetSession [[-ComputerName] <String[]>] [-Credential <PSCredential>] [<CommonParameters>]           Get session information for the local or remote machine
}}}


===== Examples =====

==== Get-NetLoggedon ====
{{{code: lang="sh" linenumbers="False"
Get-NetLoggedon
}}}

* Returns users actively logged onto the local host.

{{{code: lang="sh" linenumbers="False"
Get-NetLoggedon -ComputerName sqlserver
}}}

* Returns users actively logged onto the 'sqlserver' host.

{{{code: lang="texinfo" linenumbers="False"
Get-DomainController | Get-NetLoggedon
}}}

* Returns all logged on users for all computers in the domain.

==== Get-Session ====
{{{code: lang="sh" linenumbers="False"
Get-NetSession
}}}

* Returns active sessions on the local host.

{{{code: lang="sh" linenumbers="False"
Get-NetSession -ComputerName sqlserver
}}}

* Returns active sessions on the 'sqlserver' host.

{{{code: lang="texinfo" linenumbers="False"
Get-DomainController | Get-NetSession
}}}

* Returns active sessions on all domain controllers.

===== SEE =====
[[Technologies:Windows:Active Directory]]
[[Enumeration:Windows:Active Directory]]
