Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-29T16:52:29-05:00

====== Get-SPN.ps1 ======
Created Friday 29 October 2021

===== Description =====
 Displays Service Principal Names (SPN) for domain accounts based on SPN service name, domain account, or domain group via LDAP queries.

===== Website =====

===== Installation =====
{{{code: lang="sh" linenumbers="False"
sudo wget https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/situational_awareness/network/Get-SPN.ps1 -O /usr/share/windows-resources/powershell_scripts/Get_SPN.ps1
}}}


===== Usage =====
{{{code: lang="sh" linenumbers="False"
powershell -ExecutionPolicy Bypass
}}}

{{{code: lang="powershell" linenumbers="False"
Import-Module .\Get_SPN.ps1   # Don't forget the the .\ else it will look in the modules directory

Get-SPN [[-Credential] <PSCredential>] [[-DomainController] <String>] [[-Limit] <Int32>] [[-SearchScope] <String>]
    [[-SearchDN] <String>] [-Type] <String> [-Search] <String> [[-List] <String>] [<CommonParameters>]
}}}


===== Commands =====
{{{code: lang="texinfo" linenumbers="False"
Get-Help Get-SPN  						Gets help on the command

Get-SPN -type <user>					Performs the search query on the "account" field
Get-SPN -type <service>					Performs the search query on the "service" field 

-search	<query>							Specifies the query								

}}}


===== Examples =====
{{{code: lang="sh" linenumbers="False"
Get-SPN -type service -search "MSSQLSvc*"
}}}

* Searches for services that start with MSSQLSvc

{{{code: lang="sh" linenumbers="False"
Get-SPN -type user -search "*sql*"
}}}

* Searches for services of which the running accountname contains sql

===== SEE =====
[[Enumeration:Windows:Active Directory]]
