Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-27T15:54:06-05:00

====== netsh ======
Created Wednesday 27 October 2021

===== Description =====

===== Installation =====
* Built into windows
* Requires IP helper to run
* Requires IPv6 to be enabled

===== Usage =====
{{{code: lang="sh" linenumbers="False"

}}}


===== Options =====
{{{code: lang="texinfo" linenumbers="False"
netsh advfirewall						Changes to the netsh advfirewall context
}}}


==== advfirewall ====
{{{code: lang="texinfo" linenumbers="False"
netsz advfirewall firewall				Changes to the netsh advfirewall firewall
}}}


=== advfirewall firewall ===
{{{code: lang="texinfo" linenumbers="False"
netsz advfirewall firewall add rule 	Adds a rule to the firewall
}}}


=== advfirewall firewall add rule ===
{{{code: lang="texinfo" linenumbers="False"
name=<name>																					
dir=in|out
action=allow|block|bypass
[program=<program path>]																							default=any
[service=<service short name>|any]
[description=<string>]																								default=""
[enable=yes|no]																										default=yes
[profile=public|private|domain|any[,...]]																			default=all
[localip=any|<IPv4 address>|<IPv6 address>|<subnet>|<range>|<list>]													default=any
[remoteip=any|localsubnet|dns|dhcp|wins|defaultgateway|<IPv4 address>|<IPv6 address>|<subnet>|<range>|<list>]		default=any
[localport=0-65535|<port range>[,...]|RPC|RPC-EPMap|IPHTTPS|any]													default=any
[remoteport=0-65535|<port range>[,...]|any]																			default=any
[protocol=0-255|icmpv4|icmpv6|icmpv4:type,code|icmpv6:type,code|tcp|udp|any]										default=any
[interfacetype=wireless|lan|ras|any]
[rmtcomputergrp=<SDDL string>]
[rmtusrgrp=<SDDL string>]
[edge=yes|deferapp|deferuser|no]																					default=no
[security=authenticate|authenc|authdynenc|authnoencap|notrequired]													default=notrequired
}}}


===== Examples =====

===== Set up a host as a pivot =====
{{{code: lang="sh" linenumbers="False"
netsh interface portproxy add v4tov4 listenport=4455 listenaddress=10.11.0.22 connectport=445 connectaddress=192.168.1.110
}}}

* Adds a ipv4 to ipv4 port proxy
* Will listen on 10.11.0.22:4455 and forward the connection to 192.168.1.110:445

===== Add firewall rule =====
{{{code: lang="sh" linenumbers="False"
netsh advfirewall firewall add rule name="forward_port_rule" protocol=TCP dir=in localip=10.11.0.22 localport=4455 action=allow
}}}

* Allows an incoming connection  on 10.11.0.22:4455
* Don't use 0.0.0.0 as localip, it won't work
