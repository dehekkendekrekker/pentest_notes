Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-22T15:52:47-05:00

====== Unquoted Service Paths ======
Created Friday 22 October 2021

A service is basically just an executable on the filesystem.
Third party services are usually stored in "C:\Program Files\My Service\My Executable.exe

If the service path (The entry in the registry(?) that references the executable is unquoted, something interesting happens, because then the path can be interpreted as such:
{{{code: lang="texinfo" linenumbers="False"
executable: C:\Program  								args: Files\My Service\My Executable.exe
executable: C:\Program Files\My							args: Service\My Executable.exe
executable: C:\Program Files\My Service\My      		args: Executable.exe
executable: C:\Program Files\My Service\My Executable	args: <none
}}}


Window will try from top to bottom a program to execute. If we can inject a program in the search path before it reaches the ligitimate target, we can escalagte.

===== Remarks =====
* Windows does not all a regular user to stores files in c:\ or c:\Program Files\. So path enumeration should be done to see which packages are vulnerable.
{{{code: lang="sh" linenumbers="False"
accesschk.exe -uws "<username>" "C:\Program Files" /accepteula
}}}



===== SEE =====
[[Tools:Windows:SysInternals:accesschk]]
