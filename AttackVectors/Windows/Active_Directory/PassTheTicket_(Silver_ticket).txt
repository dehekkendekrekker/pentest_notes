Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-11-02T15:06:41-05:00

====== PassTheTicket (Silver ticket) ======
Created Tuesday 02 November 2021

Involves generating a silver ticket

===== Description =====
* This technique involves generating a so-called silver ticket that grants the user arbitrary access to the targeted service.
* This technique can be executed on low-privileged accounts
* Does not query the DC. 

===== Requirements =====
* Username of user (can be fake)
* Domain's SID (whoami /user)
* Target server's FQDN
* SPN name of service
* The NTLM hash of the service account the service runs under.
	* This can be extracted from memory using [[Tools:Windows:mimikatz]]
	* Using [[Kerberoasting]] (brute force password retrieval) and then hashing the password  using SANANGO's ntlm hash tool

===== Step 1 =====
Get the NTLM hash, either by kerberoasting or mimikatz dumping

===== Step 2 =====
Get the domain's SID
{{{code: lang="sh" linenumbers="False"
whoami /user
}}}


===== Step 3 =====
Run this mimikatz command to generate and inject the silver ticket in memory:
{{{code: lang="powershell" linenumbers="False"
kerberos::golden /user:<user> /domain:<fqdn> /sid:<sid of domain> /target:<target_host> /rc4:<ntlm_hash> /service:<service_type> /ptt
}}}


===== Step 4 =====
* See this for a practical guide https://stealthbits.com/blog/impersonating-service-accounts-with-silver-tickets/


===== SEE =====
https://book.hacktricks.xyz/windows/active-directory-methodology/silver-ticket

